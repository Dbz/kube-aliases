#!/bin/bash

function usage {
  echo "Usage: kstatus -[a|C|c|f|p|r|s|u]"
  echo "  -a                           Search all namespaces"
  echo "  -C                           Completed"
  echo "  -c                           CrashLoopBackOff"
  echo "  -f                           Failed"
  echo "  -p                           Pending"
  echo "  -r                           Running"
  echo "  -s                           Succeeded"
  echo "  -u                           Unknown"
}

while getopts "acCfprsu?h" opt; do
  case $opt in
    a)
      flag="-a"
      ;;
    c)
      search=CrashLoopBackOff
      rflag=true
      ;;
    C)
      search=Completed
      rflag=true
      ;;
    f)
      search=Failed
      rflag=true
      ;;
    p)
      search=Pending
      rflag=true
      ;;
    r)
      search=Running
      rflag=true
      ;;
    s)
      search=Succeded
      rflag=true
      ;;
    u)
      search=Unknown
      rflag=true
      ;;
    h|\?)
      # echo "Invalid option: -$OPTARG" >&2
      usage
      exit 0
      ;;
  esac
done

if ! "$rflag"
then
  echo test
  usage
  exit 0
fi

kpfind ${flag} ${search}
